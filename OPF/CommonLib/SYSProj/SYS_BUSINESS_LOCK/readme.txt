業務ロック：SYS_BUSINESS_LOCK

「業務ロック対応表」(2015/10/26時点)
対象：EXPLANNER/J  生産・販売・標準原価・売掛・買掛・実際原価・予算見積原価
      EXPLANNER/Ja (販売）,ASP連携
      マルチカンパニーJa

実際にDBに登録するデータは"SETProj"側へ登録

０．本業務ロック対応表は、適用の手順に注意が必要です。生成sqlファイルにヘッダ・フッタ情報が
付加されるため、順序を間違えると正しく適用できません。「２．手順」を必ず確認して下さい。

１．説明
　業務ロック表は、バッチ処理の２重起動や画面系とバッチ系で同時実行できないようにロック
　するものです。
　標準の業務ロック対応表は、EXCELで作成されています。
　EXCEL2003の列数の最大256列を超える為、業務ロック表は４つのEXCELファイルに分かれています。

　　・業務ロック対応表.xls     (EXPLANNER/J)
　　・業務ロック対応表2.xls    (EXPLANNER/J 実際原価、売掛買掛)
　　・業務ロック対応表3.xls    (EXPLANNER/Ja&ASP連携)
　　・業務ロック対応表4.xls    (マルチカンパニーJa)
　　・業務ロック対応表5.xls    (予算見積原価)

　本業務ロック表はパッケージ標準です。
　システム導入時に顧客業務に合わせ、メンテナンスと評価が必要です。

２．手順
　（１）業務ロック対応表.xlsを開き、メンテナンスをします。
　（２）先頭にある「ファイル更新（保存）」ボタンでマクロが実行されます。
　（３）マクロにより「insertLock.sql」ファイルが上書きされます。              --- Excel VBA File Open OutputMode
　　　　業務ロック対応表.xlsのマクロは「insertLock.sql」ファイルに★ヘッダ情報を付加します。
　（４）業務ロック対応表2.xlsを開き、メンテナンスをします。
　（５）先頭にある「ファイル更新（保存）」ボタンでマクロが実行されます。
　（６）マクロにより「insertLock.sql」ファイルにAppendモードで書き込まれます。--- Excel VBA File Open AppendMode
　　　　業務ロック対応表2.xlsのマクロは「insertLock.sql」ファイルに★ヘッダ・フッタ情報を出力しません。
　（７）業務ロック対応表3.xlsを開き、メンテナンスをします。
　（８）先頭にある「ファイル更新（保存）」ボタンでマクロが実行されます。
　（９）マクロにより「insertLock.sql」ファイルにAppendモードで書き込まれます。--- Excel VBA File Open AppendMode
　　　　業務ロック対応表3.xlsのマクロは「insertLock.sql」ファイルに★ヘッダ・フッタ情報を出力しません。
　（10）業務ロック対応表4.xlsを開き、メンテナンスをします。
　（11）先頭にある「ファイル更新（保存）」ボタンでマクロが実行されます。
　（12）マクロにより「insertLock.sql」ファイルにAppendモードで書き込まれます。--- Excel VBA File Open AppendMode
　　　　業務ロック対応表4.xlsのマクロは「insertLock.sql」ファイルに★ヘッダ・フッタ情報を出力しません。

　（13）業務ロック対応表5.xlsを開き、メンテナンスをします。
　（14）先頭にある「ファイル更新（保存）」ボタンでマクロが実行されます。
　（15）マクロにより「insertLock.sql」ファイルにAppendモードで書き込まれます。--- Excel VBA File Open AppendMode
　　　　業務ロック対応表5.xlsのマクロは「insertLock.sql」ファイルに★フッタ情報を付加します。

　（16）（１）〜（15）で作成された「insertLock.sql」ファイルを「insertLock.bat」バッチファイル
　　　　で対象のデータベースに格納します。

　　　　★注意１：（16）のバッチ実行はデータベースの環境に合わせ、バッチファイル内のSID,USER,PASSWORD
　　　　　　　　　を書き換えて下さい。
　　　　★注意２：（１）〜（15）の手順を必ず守ってください。業務ロック対応表.xlsのマクロはヘッダ情報
　　　　　　　　　業務ロック対応表2.xlsのマクロはフッダ情報を付加する為、実行順序を誤ると正しく動作
　　　　　　　　　しません。

